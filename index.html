<!DOCTYPE html>  
<html lang="ja">
    <head>
        <meta charset="utf-8" />
        <meta name="description" content="大放技イベント登録フォーム" />
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />
        <title>大放技登録フォーム</title>
        <link rel="shortcut icon" href="favicon.ico">
        <link rel="apple-touch-icon" sizes="180x180" href="favicon.ico">
        <link rel="stylesheet" href="css/style.css" media="all" />
    </head>

    <body>
        <div class="contact">           
            <h1 class="contact-ttl" id="edit_area2">イベント申込フォーム</h1>
            <img src="top.jpg" alt="写真" width="100%" height="100%">   
            <form action="https://docs.google.com/forms/u/0/d/e/1FAIpQLScW5f9BdCumnX97K2k1FuA5Y5_FYyKUjbPasgSmq0A7sUuK5A/formResponse" method="post" target="hidden_iframe" onsubmit="submitted=true;">

                <table class="contact-table">
                    <tr>
                        <th class="contact-item">メールアドレス</th>
                        <td class="contact-body">
                            <input id="email_1" name="emailAddress" type="email" required="required" placeholder="必須" class="form-text"/>
                        </td>
                    </tr>
                    <tr>
                        <th class="contact-item">メールアドレス<br>（確認用）</th>
                        <td class="contact-body">
                            <input type="email" id="email_2" required="required" placeholder="必須" name="emailAddress" class="form-text" oninput="CheckEmail_2(this)" value=""/>
                        </td>
                    </tr>
                   
                    <tr>
                        <th class="contact-item">氏　名</th>
                        <td class="contact-body">
                            <input type="text" name="entry.1498135098" required="required" placeholder="必須" class="form-text"/>           
                        </td>
                    </tr>
                    <tr>
                        <th class="contact-item">施設名・学校名</th>
                        <td class="contact-body">
                            <input type="text" name="entry.877086558" required="required" placeholder="必須" class="form-text2"/>
                        </td>
                    </tr>
                    <tr>
                        <th class="contact-item">イベント名</th>
                        <td class="contact-body">
                            <label class="contact-keitai">
                                <input type="radio" id="event1" name="entry.2100736645" required="required" value="2023年2月16日（木）「手話講座」人権委員会" checked="checked"/>
                                <span class="contact-skill-txt" id="edit_area10">2023年2月16日（木）「手話講座」人権委員会</span>
                            </label>
                            <label class="contact-skill">
                                <input type="radio" id="event2" name="entry.2100736645" value="2023年3月4日（土）組織部学術セミナー（担当：北ブロック）申し込み不要" disabled/>
                                <span class="contact-skill-txt" id="edit_area20">2023年3月4日（土）組織部学術セミナー（担当：北ブロック）申し込み不要</span>
                            </label>                                                                               
                        </td>
                    </tr>

                    <tr>
                        <th class="contact-item">参加形態</th>
                        <td class="contact-body">
                            <label class="contact-skill">
                                <input type="radio" id="kaijyo" name="entry.1424661284" value="会場参加" checked="checked"/>
                                <span class="contact-skill-txt" id="edit_area4">会場参加のみ　会員優先 先着順12名（2月13日まで受付）</span>
                            </label>                                                           
                        </td>
                    </tr>

                    <tr>
                        <th class="contact-item">区　分</th>
                        <td class="contact-body">
                            <label class="contact-skill">
                                <input type="radio" name="entry.153040154" value="大放技会員" checked="checked" onclick="connecttext0('textforscb3',this.checked); "/>
                                <span class="contact-skill-txt">大放技会員・協賛会員・学生（社会人院生は除く）</span>
                            </label>
                            <label class="contact-skill">
                                <input type="radio" name="entry.153040154" value="日放技会員" onclick="connecttext1('textforscb3',this.checked);"/>
                                <span class="contact-skill-txt">日放技会員（他府県会員）</span>
                            </label>
                            <label class="contact-skill">
                                <input type="radio" name="entry.153040154" value="非会員" onclick="connecttext2('textforscb3',this.checked);"/>
                                <span class="contact-skill-txt">非会員（非会員の方も無料です）</span><br>
                            </label>
                            <label class="contact-skill">
                                <input type="radio" name="entry.153040154" value="一般府民" onclick="connecttext4('textforscb3',this.checked);"/>
                                <span class="contact-skill-txt">一般府民の方は事務所までお問い合わせください</span><br>
                                <span class="contact-skill-txt"><font size="2">TEL：06-6765-0301（平日12時～16時）メール：osaka@daihougi.ne.jp</font></span>
                            </label>
                        </td>
                    </tr>
                    
                    <tr>
                        <th class="contact-item">大放技番号</th>
                        <td class="contact-body">
                            <input type="number" name="entry.336341927" required="required" id ="dn" class="form-text3"/>
                             <font size="2"> 大放技会員は必須（4桁の数字）協賛会員・学生は"0"</font>
                        </td>
                    </tr>  
                    <tr>
                        <th class="contact-item">ブロック名</th>
                        <td class="contact-body">
                            <select name="entry.1285550799" required="required" class="form-select" id ="bn">
                            　　<option value="ブロック名" >選択してください</option>
                                <option value="中央ブロック">中央ブロック</option>
                                <option value="東ブロック" >東ブロック</option>
                                <option value="西ブロック" >西ブロック</option>
                                <option value="南ブロック" >南ブロック</option>
                                <option value="北ブロック" >北ブロック</option>
                                <option value="協賛会員" >協賛会員</option>
                                <option value="学生" >学生</option>
                            </select> <font size="2"> 大放技会員、協賛会員、学生は必須</font>
                        </td>
                    </tr>
                    <tr>
                        <th class="contact-item">日放技番号</th>
                        <td class="contact-body">
                            <input type="number" name="entry.2017430449" required="required" id ="nn" class="form-text3"/>
                             <font size="2"> 日放技会員は必須（5桁の数字）協賛会員・学生は"0"</font>
                        </td>
                    </tr>
                    <tr>
                        <th class="contact-item">都道府県</th>
                        <td class="contact-body">
                            <input type="text" name="entry.681003941" required="required" id ="todoufuken" disabled="disabled" class="form-text3"/>
                             <font size="2">他府県会員は必須</font>
                        </td>
                    </tr>
                    <tr>
                        <th class="contact-item">領収書番号</th>
                        <td class="contact-body">
                            <input type="number" id ="textforscb3" name="entry.1059499032" class="form-text3" required="required" disabled="disabled"/>  <font size="2">非会員は必須（0を入力してください）</font>
                        </td>
                    </tr>
                    <tr>
                        <th class="contact-item">備　考</th>
                        <td class="contact-body">
                            <textarea name="entry.1181613713" class="form-textarea" placeholder="何かご意見やご要望・ご質問等があればご記入ください"></textarea>
                        </td>
                    </tr>
                </table>

                <input class="contact-submit" id="conf" type="submit" name="submit" value="参加申込"/>
            </form>
            <script>
                let submitted = false;
            
                const page_transition = function () {
                    if(submitted){
                        window.location = 'send.html';
                    }
                }
            </script>    
            <iframe name="hidden_iframe" style="display:none;" onload="page_transition()"></iframe>
           
            <script language="JavaScript" type="text/javascript">
           // <!--
              function CheckEmail_2(input){              
                //IE対応の為変更
                //var mail = email_2.value;
                //メールフォームの値を取得
                //var form = document.getElementById("email_1");
                var mail = document.getElementById("email_1").value; //メールフォームの値を取得
                var mailConfirm = input.value; //メール確認用フォームの値を取得(引数input)
 
                //*input.setCustomValidity(mail)
                //* パスワードの一致確認
                if(mail != mailConfirm){
                  input.setCustomValidity('メールアドレスが一致しません'); // エラーメッセージのセット
                }else{
                  input.setCustomValidity(''); // エラーメッセージのクリア
                }
              }
              function connecttext0(id, ischecked ) {           //大放技会員の場合
                  //* チェック状態に合わせて有効・無効を切り替える
                  if(ischecked==true){
                      document.getElementById("textforscb3").disabled = true;                  
                      document.getElementById("nn").disabled = false;                 
                      document.getElementById("dn").disabled = false;                 
                      document.getElementById("bn").disabled = false;
                      document.getElementById("todoufuken").disabled = true;
                      
                      document.getElementById("conf").style.backgroundColor = "blue";  //府民用から復活
                      document.getElementById("conf").value = "参加申込";  //府民用から復活
                      document.getElementById("conf").disabled = false;  //府民用から復活
                  }
              }
              function connecttext1(id, ischecked ) {           //他府県会員の場合
                  //* チェック状態に合わせて有効・無効を切り替える
                  if(ischecked==true){
                      document.getElementById("textforscb3").disabled = true;            
                      document.getElementById("nn").disabled = false;                 
                      document.getElementById("dn").disabled = true;                 
                      document.getElementById("bn").disabled = true;
                      document.getElementById("todoufuken").disabled = false;

                      document.getElementById("conf").style.backgroundColor = "blue";  //府民用から復活
                      document.getElementById("conf").value = "参加申込";  //府民用から復活
                      document.getElementById("conf").disabled = false;  //府民用から復活
                  }
              }
              function connecttext2(id, ischecked ) {            //非会員の場合
                  //* チェック状態に合わせて有効・無効を切り替える
                  if(ischecked==true){
                      document.getElementById("textforscb3").disabled = false;
                      document.getElementById("nn").disabled = true;                 
                      document.getElementById("dn").disabled = true;                 
                      document.getElementById("bn").disabled = true;
                      document.getElementById("todoufuken").disabled = true;
                      
                      document.getElementById("conf").style.backgroundColor = "blue";  //府民用から復活
                      document.getElementById("conf").value = "参加申込";  //府民用から復活
                      document.getElementById("conf").disabled = false;  //府民用から復活                
                  }
              }
             //  function connecttext3(id, ischecked ) {
                  // チェック状態に合わせて有効・無効を切り替える
                  // if(ischecked==true){
                     //  document.getElementById("textforscb3").disabled = true;
                     //  document.getElementById("nn").disabled = true;                 
                     //  document.getElementById("dn").disabled = true;                 
                     //  document.getElementById("bn").disabled = true;
                  // }
             //  }
              function connecttext4(id, ischecked ) {            //府民の場合
                  //* チェック状態に合わせて有効・無効を切り替える
                  if(ischecked==true){
                      document.getElementById("textforscb3").disabled = true;
                      document.getElementById("nn").disabled = true;                 
                      document.getElementById("dn").disabled = true;                 
                      document.getElementById("bn").disabled = true;
                      document.getElementById("todoufuken").disabled = true;

                      document.getElementById("conf").style.backgroundColor = "gray";  //府民用グレイアウトする
                      document.getElementById("conf").value = "申込不可";  //府民用レイアウトする
                      document.getElementById("conf").disabled = true;  //府民用押せなくする                      
                  }
              }              
              
              //  開催日・会場参加の締め切り日設定
              var kaisai_day1 = new Date("2023-02-16T23:59:59");  // event1(MRI) の開催日を指定 '2021-12-16T16:36:59'
              var kaisai_day2 = new Date("2023-03-04T23:59:59");  // event2(組織)の開催日を指定 '2021-12-16T16:36:59'
              var today = new Date();                             // 今日の日付を取得 
              var todaytime  = today.getTime();                   // 今日の日付を時間に変換 
              var web1_endtime  = kaisai_day1.getTime();          // 開催日（締切日）を時間に変換

              //　ここを変更！！  もしevent1の定員がいっぱいになった時は”-3”を大きな数字に代えて，締め切る！！！
              var kaijyo1_endtime  = kaisai_day1.setDate(kaisai_day1.getDate() -3); // 締切日を3日前にして時間に変換
              var comment1 = "";

              if(web1_endtime < todaytime){// event1開催日にWebも締め切り
                
                comment1= "<font color='red'>注：上記イベントは締め切りました</font>";
                document.getElementById("edit_area1").innerHTML = comment1;
                document.getElementById("event1").disabled = true;
                document.getElementById("edit_area10").style.color = "gray";    

                }else if(kaijyo1_endtime < todaytime){// 会場参加の締め切り 
                  let event1 = document.getElementById('event1');
                  event1.addEventListener('change', valueChange1);
                  let event2 = document.getElementById('event2');           
                  event2.addEventListener('change', valueChange2);
                  comment1= "<font color='red'>注：上記イベントの会場参加は締め切りました</font>";
                  document.getElementById("edit_area1").innerHTML = comment1;

                  function valueChange1(){
                    if (event1.checked) {
                      document.getElementById("kaijyo").disabled = true;
                      document.getElementById("edit_area4").style.color = "gray";              
                    }
                  }
                  function valueChange2(){
                    if (event2.checked) {
                      document.getElementById("kaijyo").disabled = false;
                      document.getElementById("edit_area4").style.color = "black";                   
                    }  
                  }   
               }


              //* イベント終了後
             //*var endObj2   = new Date("開催日を指定");  // 開催日を指定 '2021-12-16T16:36:59'
              //*var end2   = endObj2.getTime();
             //* var comment2 = "";
              //*if(end2 <= today){// 有効期限の範囲外
             //*     comment2= "<font color='red'>このイベントは終了しました</font>";
              //*    document.getElementById("edit_area2").innerHTML = comment2;
              //*    document.getElementById("conf").style.backgroundColor = "gray";  //締切後グレイアウトする
             //*     document.getElementById("conf").value = "終　了";  //締切後レイアウトする
              //*    document.getElementById("conf").disabled = true;  //締切後押せなくする      
                               //*<button style="background-color:red">締　切</button>
             //* }                 
            //* -->
            </script>            
        </div>
    </body>
</html>
